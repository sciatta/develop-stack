
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>SparkSQL核心功能 · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-search-pro/search.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-pageview-count/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-auto-scroll-table/website.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-donate/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../Spark集群安装部署.html" />
    
    

    <style>
    @media only screen and (max-width: 640px) {
        .book-header .hidden-mobile {
            display: none;
        }
    }
    </style>
    <script>
        window["gitbook-plugin-github-buttons"] = {"buttons":[{"user":"sciatta","repo":"develop-stack","type":"star","count":true,"size":"small"}]};
    </script>

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../../../">
            
                <a href="../../../../">
            
                    
                    前言
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    Develop
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" >
            
                <span>
            
                    
                    Java
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" >
            
                <span>
            
                    
                    JVM
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1.1" data-path="../../java/jvm/JVM核心技术.html">
            
                <a href="../../java/jvm/JVM核心技术.html">
            
                    
                    JVM核心技术
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.1.2" data-path="../../java/jvm/JDK工具.html">
            
                <a href="../../java/jvm/JDK工具.html">
            
                    
                    JDK工具
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.1.2" >
            
                <span>
            
                    
                    IO
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.2.1" data-path="../../java/io/NIO模型与Netty.html">
            
                <a href="../../java/io/NIO模型与Netty.html">
            
                    
                    NIO模型与Netty
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.1.3" >
            
                <span>
            
                    
                    Concurrency
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.3.1" data-path="../../java/concurrency/并发编程.html">
            
                <a href="../../java/concurrency/并发编程.html">
            
                    
                    并发编程
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2" >
            
                <span>
            
                    
                    Algorithm
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1" data-path="../../algorithm/数据结构和算法.html">
            
                <a href="../../algorithm/数据结构和算法.html">
            
                    
                    数据结构和算法
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.3" >
            
                <span>
            
                    
                    Spring
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.3.1" data-path="../../spring/SpringCore核心功能.html">
            
                <a href="../../spring/SpringCore核心功能.html">
            
                    
                    SpringCore核心功能
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.2" data-path="../../spring/SpringBoot核心功能.html">
            
                <a href="../../spring/SpringBoot核心功能.html">
            
                    
                    SpringBoot核心功能
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.4" >
            
                <span>
            
                    
                    RPC
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1" >
            
                <span>
            
                    
                    Dubbo
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1.1" data-path="../../rpc/dubbo/Dubbo源码分析.html">
            
                <a href="../../rpc/dubbo/Dubbo源码分析.html">
            
                    
                    Dubbo源码分析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.5" >
            
                <span>
            
                    
                    MQ
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.5.1" >
            
                <span>
            
                    
                    Kafka
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.5.1.1" data-path="../../mq/kafka/Kafka集群安装部署.html">
            
                <a href="../../mq/kafka/Kafka集群安装部署.html">
            
                    
                    Kafka集群安装部署
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5.1.2" data-path="../../mq/kafka/Kafka监控工具.html">
            
                <a href="../../mq/kafka/Kafka监控工具.html">
            
                    
                    Kafka监控工具
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5.1.3" data-path="../../mq/kafka/Kafka分布式消息流平台.html">
            
                <a href="../../mq/kafka/Kafka分布式消息流平台.html">
            
                    
                    Kafka分布式消息流平台
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.6" >
            
                <span>
            
                    
                    Hadoop
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.6.1" >
            
                <span>
            
                    
                    HDFS
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.6.1.1" data-path="../../hadoop/hdfs/HDFS核心功能原理.html">
            
                <a href="../../hadoop/hdfs/HDFS核心功能原理.html">
            
                    
                    HDFS核心功能原理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.1.2" data-path="../../hadoop/hdfs/HDFS命令.html">
            
                <a href="../../hadoop/hdfs/HDFS命令.html">
            
                    
                    HDFS命令
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.1.3" data-path="../../hadoop/hdfs/HDFS源码分析.html">
            
                <a href="../../hadoop/hdfs/HDFS源码分析.html">
            
                    
                    HDFS源码分析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.6.2" >
            
                <span>
            
                    
                    MapReduce
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.6.2.1" data-path="../../hadoop/mapreduce/MapReduce工作原理.html">
            
                <a href="../../hadoop/mapreduce/MapReduce工作原理.html">
            
                    
                    MapReduce工作原理
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.6.3" >
            
                <span>
            
                    
                    YARN
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.6.3.1" data-path="../../hadoop/yarn/YARN架构.html">
            
                <a href="../../hadoop/yarn/YARN架构.html">
            
                    
                    YARN架构
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.6.4" data-path="../../hadoop/Hadoop集群安装部署.html">
            
                <a href="../../hadoop/Hadoop集群安装部署.html">
            
                    
                    Hadoop集群安装部署
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.5" data-path="../../hadoop/Hadoop HA集群安装部署.html">
            
                <a href="../../hadoop/Hadoop HA集群安装部署.html">
            
                    
                    Hadoop HA集群安装部署
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.6" data-path="../../hadoop/Hadoop企业级调优.html">
            
                <a href="../../hadoop/Hadoop企业级调优.html">
            
                    
                    Hadoop企业级调优
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.7" >
            
                <span>
            
                    
                    ZooKeeper
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.7.1" data-path="../../zookeeper/ZooKeeper集群安装部署.html">
            
                <a href="../../zookeeper/ZooKeeper集群安装部署.html">
            
                    
                    ZooKeeper集群安装部署
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.2" data-path="../../zookeeper/ZooKeeper分布式协调框架.html">
            
                <a href="../../zookeeper/ZooKeeper分布式协调框架.html">
            
                    
                    ZooKeeper分布式协调框架
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.8" >
            
                <span>
            
                    
                    Hive
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.8.1" data-path="../../hive/Hive安装部署.html">
            
                <a href="../../hive/Hive安装部署.html">
            
                    
                    Hive安装部署
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.2" data-path="../../hive/大数据分析利器之Hive.html">
            
                <a href="../../hive/大数据分析利器之Hive.html">
            
                    
                    大数据分析利器之Hive
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.3" data-path="../../hive/Hive调优.html">
            
                <a href="../../hive/Hive调优.html">
            
                    
                    Hive调优
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.9" >
            
                <span>
            
                    
                    HBase
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.9.1" data-path="../../hbase/HBase集群安装部署.html">
            
                <a href="../../hbase/HBase集群安装部署.html">
            
                    
                    HBase集群安装部署
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9.2" data-path="../../hbase/大数据数据库之HBase.html">
            
                <a href="../../hbase/大数据数据库之HBase.html">
            
                    
                    大数据数据库之HBase
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.10" >
            
                <span>
            
                    
                    Flume
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.10.1" data-path="../../flume/Flume安装部署.html">
            
                <a href="../../flume/Flume安装部署.html">
            
                    
                    Flume安装部署
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.10.2" data-path="../../flume/Flume数据采集.html">
            
                <a href="../../flume/Flume数据采集.html">
            
                    
                    Flume数据采集
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.11" >
            
                <span>
            
                    
                    Sqoop
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.11.1" data-path="../../sqoop/Sqoop安装部署.html">
            
                <a href="../../sqoop/Sqoop安装部署.html">
            
                    
                    Sqoop安装部署
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.11.2" data-path="../../sqoop/Sqoop数据迁移.html">
            
                <a href="../../sqoop/Sqoop数据迁移.html">
            
                    
                    Sqoop数据迁移
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.12" >
            
                <span>
            
                    
                    Azkaban
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.12.1" data-path="../../azkaban/Azkaban安装部署.html">
            
                <a href="../../azkaban/Azkaban安装部署.html">
            
                    
                    Azkaban安装部署
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.12.2" data-path="../../azkaban/Azkaban工作流调度器.html">
            
                <a href="../../azkaban/Azkaban工作流调度器.html">
            
                    
                    Azkaban工作流调度器
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.13" >
            
                <span>
            
                    
                    Spark
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.13.1" >
            
                <span>
            
                    
                    SparkCore
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.13.1.1" data-path="../sparkcore/SparkCore核心功能.html">
            
                <a href="../sparkcore/SparkCore核心功能.html">
            
                    
                    SparkCore核心功能
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.13.1.2" data-path="../sparkcore/Spark调优.html">
            
                <a href="../sparkcore/Spark调优.html">
            
                    
                    Spark调优
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.13.2" >
            
                <span>
            
                    
                    SparkSQL
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.2.13.2.1" data-path="SparkSQL核心功能.html">
            
                <a href="SparkSQL核心功能.html">
            
                    
                    SparkSQL核心功能
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.13.3" data-path="../Spark集群安装部署.html">
            
                <a href="../Spark集群安装部署.html">
            
                    
                    Spark集群安装部署
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Database
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" >
            
                <span>
            
                    
                    MySQL
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="../../../database/mysql/MySQL安装.html">
            
                <a href="../../../database/mysql/MySQL安装.html">
            
                    
                    MySQL安装
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="../../../database/mysql/MySQL实践.html">
            
                <a href="../../../database/mysql/MySQL实践.html">
            
                    
                    MySQL实践
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.3" data-path="../../../database/mysql/SQL经典50题.html">
            
                <a href="../../../database/mysql/SQL经典50题.html">
            
                    
                    SQL经典50题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" >
            
                <span>
            
                    
                    Redis
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="../../../database/redis/Redis核心功能.html">
            
                <a href="../../../database/redis/Redis核心功能.html">
            
                    
                    Redis核心功能
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    VersionControl
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" >
            
                <span>
            
                    
                    Git
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="../../../versioncontrol/git/GitBook&GitHub&Typora最佳实践.html">
            
                <a href="../../../versioncontrol/git/GitBook&GitHub&Typora最佳实践.html">
            
                    
                    GitBook&GitHub&Typora最佳实践
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" data-path="../../../versioncontrol/git/Git命令.html">
            
                <a href="../../../versioncontrol/git/Git命令.html">
            
                    
                    Git命令
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.3" data-path="../../../versioncontrol/git/GitHub日常使用.html">
            
                <a href="../../../versioncontrol/git/GitHub日常使用.html">
            
                    
                    GitHub日常使用
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    Virtualization
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" >
            
                <span>
            
                    
                    VMware
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1.1" data-path="../../../virtualization/vmware/VMware系统安装.html">
            
                <a href="../../../virtualization/vmware/VMware系统安装.html">
            
                    
                    VMware系统安装
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2" >
            
                <span>
            
                    
                    Docker
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.1" data-path="../../../virtualization/docker/Docker实践.html">
            
                <a href="../../../virtualization/docker/Docker实践.html">
            
                    
                    Docker实践
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                    OS
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" >
            
                <span>
            
                    
                    Linux
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1.1" data-path="../../../os/linux/Linux命令.html">
            
                <a href="../../../os/linux/Linux命令.html">
            
                    
                    Linux命令
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.1.2" data-path="../../../os/linux/iTerm的使用.html">
            
                <a href="../../../os/linux/iTerm的使用.html">
            
                    
                    iTerm的使用
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" >
            
                <span>
            
                    
                    IDE
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" >
            
                <span>
            
                    
                    IntelliJ IDEA
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1.1" data-path="../../../ide/intellijidea/IDEA配置开发环境.html">
            
                <a href="../../../ide/intellijidea/IDEA配置开发环境.html">
            
                    
                    IDEA配置开发环境
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.1.2" data-path="../../../ide/intellijidea/IDEA创建GitHub项目.html">
            
                <a href="../../../ide/intellijidea/IDEA创建GitHub项目.html">
            
                    
                    IDEA创建GitHub项目
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" >
            
                <span>
            
                    
                    CloudPlatform
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" >
            
                <span>
            
                    
                    vultr
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1.1" data-path="../../../cloudplatform/vultr/Shadowsocks服务端配置.html">
            
                <a href="../../../cloudplatform/vultr/Shadowsocks服务端配置.html">
            
                    
                    Shadowsocks服务端配置
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" >
            
                <span>
            
                    
                    [后记]
            
                </span>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../../.." >SparkSQL核心功能</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><li><span class="title-icon "></span><a href="#&#x6982;&#x8FF0;"><b>1. </b>&#x6982;&#x8FF0;</a></li><li><span class="title-icon "></span><a href="#dataframe"><b>2. </b>DataFrame</a></li><ul><li><span class="title-icon "></span><a href="#&#x6982;&#x8FF0;_1"><b>2.1. </b>&#x6982;&#x8FF0;</a></li><li><span class="title-icon "></span><a href="#dataframe&#x548C;rdd&#x7684;&#x4F18;&#x7F3A;&#x70B9;"><b>2.2. </b>DataFrame&#x548C;RDD&#x7684;&#x4F18;&#x7F3A;&#x70B9;</a></li><ul><li><span class="title-icon "></span><a href="#rdd"><b>2.2.1. </b>RDD</a></li><li><span class="title-icon "></span><a href="#dataframe_1"><b>2.2.2. </b>DataFrame</a></li></ul><li><span class="title-icon "></span><a href="#&#x5E38;&#x7528;&#x64CD;&#x4F5C;"><b>2.3. </b>&#x5E38;&#x7528;&#x64CD;&#x4F5C;</a></li><ul><li><span class="title-icon "></span><a href="#dsl&#xFF08;domain-specific-language&#xFF09;&#x98CE;&#x683C;&#x8BED;&#x6CD5;"><b>2.3.1. </b>DSL&#xFF08;domain-specific language&#xFF09;&#x98CE;&#x683C;&#x8BED;&#x6CD5;</a></li><li><span class="title-icon "></span><a href="#sql&#xFF08;standard-query-language&#xFF09;&#x98CE;&#x683C;&#x8BED;&#x6CD5;"><b>2.3.2. </b>SQL&#xFF08;Standard Query Language&#xFF09;&#x98CE;&#x683C;&#x8BED;&#x6CD5;</a></li></ul></ul><li><span class="title-icon "></span><a href="#dataset"><b>3. </b>DataSet</a></li><ul><li><span class="title-icon "></span><a href="#&#x6982;&#x8FF0;_2"><b>3.1. </b>&#x6982;&#x8FF0;</a></li><li><span class="title-icon "></span><a href="#&#x5E38;&#x7528;&#x64CD;&#x4F5C;_1"><b>3.2. </b>&#x5E38;&#x7528;&#x64CD;&#x4F5C;</a></li></ul><li><span class="title-icon "></span><a href="#&#x7CFB;&#x7EDF;&#x96C6;&#x6210;"><b>4. </b>&#x7CFB;&#x7EDF;&#x96C6;&#x6210;</a></li><ul><li><span class="title-icon "></span><a href="#hive&#x96C6;&#x6210;"><b>4.1. </b>Hive&#x96C6;&#x6210;</a></li><ul><li><span class="title-icon "></span><a href="#&#x672C;&#x5730;&#x652F;&#x6301;hivesql"><b>4.1.1. </b>&#x672C;&#x5730;&#x652F;&#x6301;HiveSQL</a></li><li><span class="title-icon "></span><a href="#&#x8054;&#x52A8;hive"><b>4.1.2. </b>&#x8054;&#x52A8;Hive</a></li></ul><li><span class="title-icon "></span><a href="#mysql&#x96C6;&#x6210;"><b>4.2. </b>MySQL&#x96C6;&#x6210;</a></li></ul></ul></div><a href="#&#x6982;&#x8FF0;" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><h1 id="&#x6982;&#x8FF0;"><a name="&#x6982;&#x8FF0;" class="anchor-navigation-ex-anchor" href="#&#x6982;&#x8FF0;"><i class="fa fa-link" aria-hidden="true"></i></a>1. &#x6982;&#x8FF0;</h1>
<p>SparkSQL&#x662F;Apache Spark&#x7528;&#x6765;&#x5904;&#x7406;<strong>&#x7ED3;&#x6784;&#x5316;&#x6570;&#x636E;</strong>&#x7684;&#x4E00;&#x4E2A;&#x6A21;&#x5757;&#x3002;</p>
<ul>
<li>&#x6613;&#x96C6;&#x6210;<ul>
<li>&#x5C06;SQL&#x67E5;&#x8BE2;&#x4E0E;Spark&#x7A0B;&#x5E8F;&#x65E0;&#x7F1D;&#x6DF7;&#x5408;</li>
<li>&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E0D;&#x540C;&#x7684;&#x8BED;&#x8A00;&#x8FDB;&#x884C;&#x4EE3;&#x7801;&#x5F00;&#x53D1;&#xFF0C;&#x5982;Java&#xFF0C;Scala&#xFF0C;Python &#x548C; R</li>
</ul>
</li>
<li>&#x7EDF;&#x4E00;&#x6570;&#x636E;&#x8BBF;&#x95EE;<ul>
<li>&#x4EE5;&#x76F8;&#x540C;&#x7684;&#x65B9;&#x5F0F;&#x8FDE;&#x63A5;&#x5230;&#x4EFB;&#x4F55;&#x6570;&#x636E;&#x6E90;</li>
</ul>
</li>
<li>&#x517C;&#x5BB9;Hive<ul>
<li>&#x8FD0;&#x884C; SQL &#x6216;&#x8005; HiveQL &#x67E5;&#x8BE2;&#x5DF2;&#x5B58;&#x5728;&#x7684;&#x6570;&#x636E;&#x4ED3;&#x5E93;</li>
</ul>
</li>
<li>&#x652F;&#x6301;&#x6807;&#x51C6;&#x7684;&#x6570;&#x636E;&#x5E93;&#x8FDE;&#x63A5;</li>
</ul>
<h1 id="dataframe"><a name="dataframe" class="anchor-navigation-ex-anchor" href="#dataframe"><i class="fa fa-link" aria-hidden="true"></i></a>2. DataFrame</h1>
<h2 id="&#x6982;&#x8FF0;_1"><a name="&#x6982;&#x8FF0;_1" class="anchor-navigation-ex-anchor" href="#&#x6982;&#x8FF0;_1"><i class="fa fa-link" aria-hidden="true"></i></a>2.1. &#x6982;&#x8FF0;</h2>
<ul>
<li>&#x5728;Spark&#x4E2D;&#xFF0C;DataFrame&#x662F;&#x4E00;&#x79CD;&#x4EE5;RDD&#x4E3A;&#x57FA;&#x7840;&#x7684;&#x5206;&#x5E03;&#x5F0F;&#x6570;&#x636E;&#x96C6;&#xFF0C;&#x7C7B;&#x4F3C;&#x4E8E;&#x4F20;&#x7EDF;&#x6570;&#x636E;&#x5E93;&#x7684;&#x4E8C;&#x7EF4;&#x8868;&#x683C;</li>
<li>DataFrame&#x5E26;&#x6709;Schema&#x5143;&#x4FE1;&#x606F;&#xFF0C;&#x5373;DataFrame&#x6240;&#x8868;&#x793A;&#x7684;&#x4E8C;&#x7EF4;&#x8868;&#x6570;&#x636E;&#x96C6;&#x7684;&#x6BCF;&#x4E00;&#x5217;&#x90FD;&#x5E26;&#x6709;&#x540D;&#x79F0;&#x548C;&#x7C7B;&#x578B;&#xFF0C;&#x4F46;&#x5E95;&#x5C42;&#x505A;&#x4E86;&#x66F4;&#x591A;&#x7684;&#x4F18;&#x5316;</li>
<li>DataFrame&#x53EF;&#x4EE5;&#x4ECE;&#x5F88;&#x591A;&#x6570;&#x636E;&#x6E90;&#x6784;&#x5EFA;&#x3002;&#x5982;&#xFF1A;&#x5DF2;&#x7ECF;&#x5B58;&#x5728;&#x7684;RDD&#x3001;&#x7ED3;&#x6784;&#x5316;&#x6587;&#x4EF6;&#x3001;&#x5916;&#x90E8;&#x6570;&#x636E;&#x5E93;&#x3001;Hive&#x8868;</li>
<li>RDD&#x53EF;&#x4EE5;&#x628A;&#x5185;&#x90E8;&#x5143;&#x7D20;&#x770B;&#x4F5C;&#x662F;java&#x5BF9;&#x8C61;&#xFF1B;&#x800C;DataFrame&#x53EF;&#x4EE5;&#x628A;&#x5185;&#x90E8;&#x5143;&#x7D20;&#x770B;&#x4F5C;&#x662F;Row&#x5BF9;&#x8C61;&#xFF0C;&#x8868;&#x793A;&#x4E00;&#x884C;&#x4E00;&#x884C;&#x7684;&#x6570;&#x636E;</li>
</ul>
<h2 id="dataframe&#x548C;rdd&#x7684;&#x4F18;&#x7F3A;&#x70B9;"><a name="dataframe&#x548C;rdd&#x7684;&#x4F18;&#x7F3A;&#x70B9;" class="anchor-navigation-ex-anchor" href="#dataframe&#x548C;rdd&#x7684;&#x4F18;&#x7F3A;&#x70B9;"><i class="fa fa-link" aria-hidden="true"></i></a>2.2. DataFrame&#x548C;RDD&#x7684;&#x4F18;&#x7F3A;&#x70B9;</h2>
<h3 id="rdd"><a name="rdd" class="anchor-navigation-ex-anchor" href="#rdd"><i class="fa fa-link" aria-hidden="true"></i></a>2.2.1. RDD</h3>
<ul>
<li>&#x4F18;&#x70B9;<ul>
<li>&#x7F16;&#x8BD1;&#x65F6;&#x7C7B;&#x578B;&#x5B89;&#x5168;</li>
<li>&#x5177;&#x6709;&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x7684;&#x7F16;&#x7A0B;&#x98CE;&#x683C;</li>
</ul>
</li>
<li>&#x7F3A;&#x70B9;<ul>
<li>&#x6784;&#x5EFA;&#x5927;&#x91CF;&#x7684;java&#x5BF9;&#x8C61;&#x5360;&#x7528;&#x4E86;&#x5927;&#x91CF;heap&#x5806;&#x7A7A;&#x95F4;&#xFF0C;&#x5BFC;&#x81F4;&#x9891;&#x7E41;&#x7684;GC&#xFF08;&#x7A0B;&#x5E8F;&#x5728;&#x8FDB;&#x884C;&#x5783;&#x573E;&#x56DE;&#x6536;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x4EFB;&#x52A1;&#x90FD;&#x662F;&#x6682;&#x505C;&#xFF0C;&#x5F71;&#x54CD;&#x7A0B;&#x5E8F;&#x6267;&#x884C;&#x7684;&#x6548;&#x7387;&#xFF09;</li>
<li>&#x6570;&#x636E;&#x7684;&#x5E8F;&#x5217;&#x5316;&#x548C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6027;&#x80FD;&#x5F00;&#x9500;&#x5F88;&#x5927;&#xFF08;&#x5305;&#x62EC;&#x5BF9;&#x8C61;&#x5185;&#x5BB9;&#x548C;&#x7ED3;&#x6784;&#xFF09;</li>
</ul>
</li>
</ul>
<h3 id="dataframe_1"><a name="dataframe_1" class="anchor-navigation-ex-anchor" href="#dataframe_1"><i class="fa fa-link" aria-hidden="true"></i></a>2.2.2. DataFrame</h3>
<p>DataFrame&#x5F15;&#x5165;&#x4E86;schema&#x5143;&#x4FE1;&#x606F;&#x548C;off-heap</p>
<ul>
<li>&#x4F18;&#x70B9;<ul>
<li>DataFrame&#x5F15;&#x5165;off-heap&#xFF0C;&#x5927;&#x91CF;&#x7684;&#x5BF9;&#x8C61;&#x6784;&#x5EFA;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5C42;&#x9762;&#x4E0A;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x4E0D;&#x5728;&#x4F7F;&#x7528;heap&#x5806;&#x4E2D;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x8FD9;&#x6837;&#x4E00;&#x6765;heap&#x5806;&#x4E2D;&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x5C31;&#x6BD4;&#x8F83;&#x5145;&#x8DB3;&#xFF0C;&#x4E0D;&#x4F1A;&#x5BFC;&#x81F4;&#x9891;&#x7E41;GC&#xFF0C;&#x7A0B;&#x5E8F;&#x7684;&#x8FD0;&#x884C;&#x6548;&#x7387;&#x6BD4;&#x8F83;&#x9AD8;&#xFF0C;&#x5B83;&#x662F;&#x89E3;&#x51B3;&#x4E86;RDD&#x6784;&#x5EFA;&#x5927;&#x91CF;&#x7684;java&#x5BF9;&#x8C61;&#x5360;&#x7528;&#x4E86;&#x5927;&#x91CF;heap&#x5806;&#x7A7A;&#x95F4;&#xFF0C;&#x5BFC;&#x81F4;&#x9891;&#x7E41;&#x7684;GC&#x8FD9;&#x4E2A;&#x7F3A;&#x70B9;</li>
<li>DataFrame&#x5F15;&#x5165;schema&#x5143;&#x4FE1;&#x606F;&#xFF08;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x7684;&#x63CF;&#x8FF0;&#x4FE1;&#x606F;&#xFF09;&#xFF0C;spark&#x7A0B;&#x5E8F;&#x4E2D;&#x7684;&#x5927;&#x91CF;&#x5BF9;&#x8C61;&#x5728;&#x8FDB;&#x884C;&#x7F51;&#x7EDC;&#x4F20;&#x8F93;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x628A;&#x6570;&#x636E;&#x7684;&#x5185;&#x5BB9;&#x672C;&#x8EAB;&#x8FDB;&#x884C;&#x5E8F;&#x5217;&#x5316;&#x5C31;&#x53EF;&#x4EE5;&#xFF0C;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x4FE1;&#x606F;&#x53EF;&#x4EE5;&#x7701;&#x7565;&#x6389;&#x3002;&#x8FD9;&#x6837;&#x4E00;&#x6765;&#x6570;&#x636E;&#x7F51;&#x7EDC;&#x4F20;&#x8F93;&#x7684;&#x6570;&#x636E;&#x91CF;&#x662F;&#x6709;&#x6240;&#x51CF;&#x5C11;&#xFF0C;&#x6570;&#x636E;&#x7684;&#x5E8F;&#x5217;&#x5316;&#x548C;&#x53CD;&#x5E8F;&#x5217;&#x6027;&#x80FD;&#x5F00;&#x9500;&#x5C31;&#x4E0D;&#x662F;&#x5F88;&#x5927;&#x4E86;&#x3002;&#x5B83;&#x662F;&#x89E3;&#x51B3;&#x4E86;RDD&#x6570;&#x636E;&#x7684;&#x5E8F;&#x5217;&#x5316;&#x548C;&#x53CD;&#x5E8F;&#x5217;&#x6027;&#x80FD;&#x5F00;&#x9500;&#x5F88;&#x5927;&#x8FD9;&#x4E2A;&#x7F3A;&#x70B9;</li>
</ul>
</li>
<li>&#x7F3A;&#x70B9;<ul>
<li>&#x7F16;&#x8BD1;&#x65F6;&#x7C7B;&#x578B;&#x4E0D;&#x5B89;&#x5168;</li>
<li>&#x4E0D;&#x518D;&#x5177;&#x6709;&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x7684;&#x7F16;&#x7A0B;&#x98CE;&#x683C;</li>
</ul>
</li>
</ul>
<h2 id="&#x5E38;&#x7528;&#x64CD;&#x4F5C;"><a name="&#x5E38;&#x7528;&#x64CD;&#x4F5C;" class="anchor-navigation-ex-anchor" href="#&#x5E38;&#x7528;&#x64CD;&#x4F5C;"><i class="fa fa-link" aria-hidden="true"></i></a>2.3. &#x5E38;&#x7528;&#x64CD;&#x4F5C;</h2>
<h3 id="dsl&#xFF08;domain-specific-language&#xFF09;&#x98CE;&#x683C;&#x8BED;&#x6CD5;"><a name="dsl&#xFF08;domain-specific-language&#xFF09;&#x98CE;&#x683C;&#x8BED;&#x6CD5;" class="anchor-navigation-ex-anchor" href="#dsl&#xFF08;domain-specific-language&#xFF09;&#x98CE;&#x683C;&#x8BED;&#x6CD5;"><i class="fa fa-link" aria-hidden="true"></i></a>2.3.1. DSL&#xFF08;domain-specific language&#xFF09;&#x98CE;&#x683C;&#x8BED;&#x6CD5;</h3>
<pre><code class="lang-scala"><span class="hljs-comment">// Michael, 29</span>
<span class="hljs-comment">// Andy, 30</span>
<span class="hljs-comment">// Justin, 19</span>
<span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">People</span>(<span class="hljs-params">name:<span class="hljs-type">String</span>,age:<span class="hljs-type">Int</span></span>)</span>

<span class="hljs-comment">// RDD[String]</span>
<span class="hljs-keyword">val</span> rdd1 = sc.textFile(<span class="hljs-string">&quot;/test/spark/people.txt&quot;</span>)
<span class="hljs-comment">// RDD[People]</span>
<span class="hljs-keyword">val</span> rdd2 = rdd1.map(_.split(<span class="hljs-string">&quot;, &quot;</span>)).map(x=&gt;<span class="hljs-type">People</span>(x(<span class="hljs-number">0</span>),x(<span class="hljs-number">1</span>).toInt))
<span class="hljs-comment">// DataFrame</span>
<span class="hljs-keyword">val</span> df = rdd2.toDF

<span class="hljs-comment">// &#x6253;&#x5370;schema</span>
df.printSchema
<span class="hljs-comment">// &#x5C55;&#x793A;&#x6570;&#x636E;</span>
df.show
df.select(<span class="hljs-string">&quot;name&quot;</span>)

<span class="hljs-comment">// $ &#x662F;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;&#x8C03;&#x7528;&#xFF0C;$&quot;name&quot; &#x76F8;&#x5F53;&#x4E8E; new ColumnName(&quot;name&quot;) &#x7684;&#x7F29;&#x5199;</span>
<span class="hljs-comment">// &#x67E5;&#x8BE2;&#x67D0;&#x4E00;&#x5217;</span>
df.select($<span class="hljs-string">&quot;name&quot;</span>)

<span class="hljs-comment">// &#x6309;&#x5E74;&#x9F84;&#x5206;&#x7EC4;</span>
df.groupBy(<span class="hljs-string">&quot;age&quot;</span>).count.show

<span class="hljs-comment">// &#x6309;&#x5E74;&#x9F84;&#x5206;&#x7EC4;&#xFF0C;&#x7EDF;&#x8BA1;&#x7ED3;&#x679C;&#x6392;&#x5E8F;</span>
df.groupBy(<span class="hljs-string">&quot;age&quot;</span>).count.sort($<span class="hljs-string">&quot;count&quot;</span>.desc).show
</code></pre>
<h3 id="sql&#xFF08;standard-query-language&#xFF09;&#x98CE;&#x683C;&#x8BED;&#x6CD5;"><a name="sql&#xFF08;standard-query-language&#xFF09;&#x98CE;&#x683C;&#x8BED;&#x6CD5;" class="anchor-navigation-ex-anchor" href="#sql&#xFF08;standard-query-language&#xFF09;&#x98CE;&#x683C;&#x8BED;&#x6CD5;"><i class="fa fa-link" aria-hidden="true"></i></a>2.3.2. SQL&#xFF08;Standard Query Language&#xFF09;&#x98CE;&#x683C;&#x8BED;&#x6CD5;</h3>
<pre><code class="lang-scala"><span class="hljs-comment">// &#x521B;&#x5EFA;&#x4E34;&#x65F6;&#x8868;</span>
df.createTempView(<span class="hljs-string">&quot;people&quot;</span>)

<span class="hljs-comment">// Spark session &#x8C03;&#x7528; sql &#x65B9;&#x6CD5;</span>
spark.sql(<span class="hljs-string">&quot;select * from people&quot;</span>).show
spark.sql(<span class="hljs-string">&quot;select age, count(*) as count from people group by age&quot;</span>).show
</code></pre>
<h1 id="dataset"><a name="dataset" class="anchor-navigation-ex-anchor" href="#dataset"><i class="fa fa-link" aria-hidden="true"></i></a>3. DataSet</h1>
<h2 id="&#x6982;&#x8FF0;_2"><a name="&#x6982;&#x8FF0;_2" class="anchor-navigation-ex-anchor" href="#&#x6982;&#x8FF0;_2"><i class="fa fa-link" aria-hidden="true"></i></a>3.1. &#x6982;&#x8FF0;</h2>
<ul>
<li>DataSet&#x662F;&#x5206;&#x5E03;&#x5F0F;&#x7684;&#x6570;&#x636E;&#x96C6;&#x5408;&#xFF0C;DataSet&#x63D0;&#x4F9B;&#x4E86;&#x5F3A;&#x7C7B;&#x578B;&#x652F;&#x6301;&#xFF0C;&#x4E5F;&#x662F;&#x5728;RDD&#x7684;&#x6BCF;&#x884C;&#x6570;&#x636E;&#x52A0;&#x4E86;&#x7C7B;&#x578B;&#x7EA6;&#x675F;</li>
<li>DataSet&#x662F;&#x5728;Spark1.6&#x4E2D;&#x6DFB;&#x52A0;&#x7684;&#x65B0;&#x7684;&#x63A5;&#x53E3;&#x3002;&#x5B83;&#x96C6;&#x4E2D;&#x4E86;RDD&#x7684;&#x4F18;&#x70B9;&#xFF08;&#x5F3A;&#x7C7B;&#x578B;&#x548C;&#x53EF;&#x4EE5;&#x7528;&#x5F3A;&#x5927;lambda&#x51FD;&#x6570;&#xFF09;&#x4EE5;&#x53CA;&#x4F7F;&#x7528;&#x4E86;Spark SQL&#x4F18;&#x5316;&#x7684;&#x6267;&#x884C;&#x5F15;&#x64CE;</li>
<li>DataSet&#x5305;&#x542B;&#x4E86;DataFrame&#x7684;&#x529F;&#x80FD;&#xFF0C;Spark2.0&#x4E2D;&#x4E24;&#x8005;&#x7EDF;&#x4E00;&#xFF0C;DataFrame&#x8868;&#x793A;&#x4E3A;DataSet[Row]&#xFF0C;&#x5373;DataSet&#x7684;&#x5B50;&#x96C6;<ul>
<li>DataSet&#x53EF;&#x4EE5;&#x5728;&#x7F16;&#x8BD1;&#x65F6;&#x68C0;&#x67E5;&#x7C7B;&#x578B;</li>
<li>&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x7684;&#x7F16;&#x7A0B;&#x63A5;&#x53E3;</li>
</ul>
</li>
</ul>
<h2 id="&#x5E38;&#x7528;&#x64CD;&#x4F5C;_1"><a name="&#x5E38;&#x7528;&#x64CD;&#x4F5C;_1" class="anchor-navigation-ex-anchor" href="#&#x5E38;&#x7528;&#x64CD;&#x4F5C;_1"><i class="fa fa-link" aria-hidden="true"></i></a>3.2. &#x5E38;&#x7528;&#x64CD;&#x4F5C;</h2>
<pre><code class="lang-scala"><span class="hljs-keyword">val</span> ds = spark.createDataset(sc.textFile(<span class="hljs-string">&quot;/test/spark/people.txt&quot;</span>))
<span class="hljs-comment">// &#x5C55;&#x793A;&#x6570;&#x636E;</span>
ds.show
</code></pre>
<h1 id="&#x7CFB;&#x7EDF;&#x96C6;&#x6210;"><a name="&#x7CFB;&#x7EDF;&#x96C6;&#x6210;" class="anchor-navigation-ex-anchor" href="#&#x7CFB;&#x7EDF;&#x96C6;&#x6210;"><i class="fa fa-link" aria-hidden="true"></i></a>4. &#x7CFB;&#x7EDF;&#x96C6;&#x6210;</h1>
<h2 id="hive&#x96C6;&#x6210;"><a name="hive&#x96C6;&#x6210;" class="anchor-navigation-ex-anchor" href="#hive&#x96C6;&#x6210;"><i class="fa fa-link" aria-hidden="true"></i></a>4.1. Hive&#x96C6;&#x6210;</h2>
<h3 id="&#x672C;&#x5730;&#x652F;&#x6301;hivesql"><a name="&#x672C;&#x5730;&#x652F;&#x6301;hivesql" class="anchor-navigation-ex-anchor" href="#&#x672C;&#x5730;&#x652F;&#x6301;hivesql"><i class="fa fa-link" aria-hidden="true"></i></a>4.1.1. &#x672C;&#x5730;&#x652F;&#x6301;HiveSQL</h3>
<ul>
<li><p>Maven&#x4F9D;&#x8D56;</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.spark<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spark-hive_2.11<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.3.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
</li>
</ul>
<ul>
<li><p>&#x81EA;&#x5B9A;&#x4E49;&#x8BBE;&#x7F6E;derby.log&#x3001;&#x6570;&#x636E;&#x4ED3;&#x5E93;&#x6570;&#x636E;&#x3001;&#x5143;&#x6570;&#x636E;&#x4F4D;&#x7F6E;</p>
<pre><code class="lang-scala"><span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Config</span> </span>{
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getLocalConfig</span></span>(appName: <span class="hljs-type">String</span>): <span class="hljs-type">SparkConf</span> = {
    <span class="hljs-comment">// &#x81EA;&#x5B9A;&#x4E49;derby.log&#x4F4D;&#x7F6E;</span>
    <span class="hljs-type">System</span>.setProperty(<span class="hljs-string">&quot;derby.system.home&quot;</span>, <span class="hljs-string">&quot;/Users/yangxiaoyu/work/test/sparkdatas/hivelocal&quot;</span>)

    <span class="hljs-keyword">val</span> sparkConf = <span class="hljs-keyword">new</span> <span class="hljs-type">SparkConf</span>()

    sparkConf
      .setMaster(<span class="hljs-string">&quot;local[2]&quot;</span>)

      .setAppName(appName)

      <span class="hljs-comment">// &#x81EA;&#x5B9A;&#x4E49;&#x6570;&#x636E;&#x4ED3;&#x5E93;&#x6570;&#x636E;&#x4F4D;&#x7F6E;</span>
      .set(<span class="hljs-string">&quot;spark.sql.warehouse.dir&quot;</span>, <span class="hljs-string">&quot;/Users/yangxiaoyu/work/test/sparkdatas/hivelocal/spark-warehouse&quot;</span>)

      <span class="hljs-comment">// &#x81EA;&#x5B9A;&#x4E49;&#x5143;&#x6570;&#x636E;&#x4F4D;&#x7F6E;</span>
      .set(<span class="hljs-string">&quot;javax.jdo.option.ConnectionURL&quot;</span>, <span class="hljs-string">&quot;jdbc:derby:;databaseName=/Users/yangxiaoyu/work/test/sparkdatas/hivelocal/metastore_db;create=true&quot;</span>)

    sparkConf
  }

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getServerConfig</span></span>(appName: <span class="hljs-type">String</span>): <span class="hljs-type">SparkConf</span> = {
    <span class="hljs-keyword">val</span> sparkConf = <span class="hljs-keyword">new</span> <span class="hljs-type">SparkConf</span>()

    sparkConf.setAppName(appName)

    sparkConf
  }
}

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">HiveLocalSupport</span> </span>{
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span></span>(args: <span class="hljs-type">Array</span>[<span class="hljs-type">String</span>]): <span class="hljs-type">Unit</span> = {
    <span class="hljs-keyword">val</span> config = <span class="hljs-type">Config</span>.getLocalConfig(getClass.getName)

    <span class="hljs-keyword">val</span> sparkSession = <span class="hljs-type">SparkSession</span>.builder().config(config).enableHiveSupport().getOrCreate()

    sparkSession.sql(<span class="hljs-string">&quot;create database if not exists test&quot;</span>)
    sparkSession.sql(<span class="hljs-string">&quot;use test&quot;</span>)
    sparkSession.sql(<span class="hljs-string">&quot;create table if not exists people(id string, name string, age int) row format delimited fields terminated by &apos; &apos;&quot;</span>)
    sparkSession.sql(<span class="hljs-string">&quot;load data local inpath &apos;/Users/yangxiaoyu/work/test/sparkdatas/people&apos; into table people&quot;</span>)
    sparkSession.sql(<span class="hljs-string">&quot;select * from people&quot;</span>).show()

    sparkSession.stop()
  }
}
</code></pre>
</li>
</ul>
<h3 id="&#x8054;&#x52A8;hive"><a name="&#x8054;&#x52A8;hive" class="anchor-navigation-ex-anchor" href="#&#x8054;&#x52A8;hive"><i class="fa fa-link" aria-hidden="true"></i></a>4.1.2. &#x8054;&#x52A8;Hive</h3>
<ul>
<li><p>&#x521D;&#x59CB;&#x5316;&#x73AF;&#x5883;</p>
<font color="red">&#x914D;&#x7F6E;&#x8BFB;&#x53D6;Hive&#x5143;&#x6570;&#x636E;</font>

<ul>
<li><p>node03&#x6267;&#x884C;</p>
<p>&#x5C06;hive&#x7684;hive-site.xml&#x5206;&#x53D1;&#x5230;&#x6240;&#x6709;spark&#x7684;conf&#x76EE;&#x5F55;&#x4E0B;&#xFF08;mysql&#x8FDE;&#x63A5;&#x4FE1;&#x606F;&#xFF09;</p>
<pre><code class="lang-bash">cp hive-site.xml /bigdata/install/spark-2.3.3-bin-hadoop2.7/conf

scp hive-site.xml node02:<span class="hljs-variable">$PWD</span>
scp hive-site.xml node01:<span class="hljs-variable">$PWD</span>
</code></pre>
</li>
<li><p>node01&#x6267;&#x884C;</p>
<p>&#x5C06;mysql&#x9A71;&#x52A8;&#x5206;&#x53D1;&#x5230;&#x6240;&#x6709;spark&#x7684;jars&#x76EE;&#x5F55;&#x4E0B;</p>
<pre><code class="lang-bash">cp mysql-connector-java-5.1.38.jar /bigdata/install/spark-2.3.3-bin-hadoop2.7/jars

scp mysql-connector-java-5.1.38.jar node02:<span class="hljs-variable">$PWD</span>
scp mysql-connector-java-5.1.38.jar node03:<span class="hljs-variable">$PWD</span>
</code></pre>
</li>
</ul>
</li>
<li><p>&#x542F;&#x52A8;&#x4EA4;&#x4E92;&#x5F0F;&#x73AF;&#x5883;</p>
<font color="red">&#x914D;&#x7F6E;&#x6570;&#x636E;&#x4ED3;&#x5E93;&#x4F4D;&#x7F6E; `spark.sql.warehouse.dir` </font>

<pre><code class="lang-bash">spark-sql \
--master spark://node01:7077 \
--executor-memory 1g \
--total-executor-cores 2 \
--conf spark.sql.warehouse.dir=hdfs://node01:8020/user/hive/warehouse
</code></pre>
<p>&#x8FD0;&#x884C;Hive&#x8BED;&#x53E5;</p>
<pre><code class="lang-mysql">select * from myhive.score;
</code></pre>
</li>
<li><p>&#x63D0;&#x4EA4;&#x811A;&#x672C;</p>
<pre><code class="lang-bash">spark-sql \
--master spark://node01:7077 \
--executor-memory 1g \
--total-executor-cores 2 \
--conf spark.sql.warehouse.dir=hdfs://node01:8020/user/hive/warehouse \
<span class="hljs-_">-e</span> <span class="hljs-string">&apos;select * from myhive.score;&apos;</span>
</code></pre>
</li>
</ul>
<h2 id="mysql&#x96C6;&#x6210;"><a name="mysql&#x96C6;&#x6210;" class="anchor-navigation-ex-anchor" href="#mysql&#x96C6;&#x6210;"><i class="fa fa-link" aria-hidden="true"></i></a>4.2. MySQL&#x96C6;&#x6210;</h2>
<ul>
<li><p>Maven&#x4F9D;&#x8D56; MySQL JDBC &#x9A71;&#x52A8;</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.1.38<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>runtime<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
</li>
</ul>
<ul>
<li><p>&#x767B;&#x5F55;Mysql&#x521B;&#x5EFA;&#x6D4B;&#x8BD5;&#x6570;&#x636E;</p>
<ul>
<li><p>&#x542F;&#x52A8;mysql&#x670D;&#x52A1;</p>
<pre><code class="lang-bash"><span class="hljs-comment"># &#x542F;&#x52A8;&#x670D;&#x52A1;</span>
systemctl start mysqld.service

<span class="hljs-comment"># &#x767B;&#x5F55;</span>
mysql -uroot -proot
</code></pre>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>&#x521B;&#x5EFA;mysql&#x6D4B;&#x8BD5;&#x6570;&#x636E;</p>
<pre><code class="lang-mysql">-- &#x521B;&#x5EFA;&#x6570;&#x636E;&#x5E93;
create database spark;

-- &#x521B;&#x5EFA;&#x8868;
use spark;
create table user(id int, name varchar(40), age int);

-- &#x63D2;&#x5165;&#x6570;&#x636E;
insert into user(id, name, age) values(1,&apos;yoyo&apos;,37);
insert into user(id, name, age) values(2,&apos;lucky&apos;,3);
insert into user(id, name, age) values(2,&apos;rain&apos;,38);
</code></pre>
</li>
</ul>
<ul>
<li><p>SparkSQL&#x901A;&#x8FC7;JDBC&#x52A0;&#x8F7D;MySQL&#x6570;&#x636E;&#x5E93;&#x8868;&#x6570;&#x636E;&#x5230;DataFrame&#xFF0C;&#x5229;&#x7528;Spark&#x5206;&#x5E03;&#x5F0F;&#x8BA1;&#x7B97;&#x6846;&#x67B6;&#x7684;&#x4F18;&#x52BF;&#xFF0C;&#x5BF9;&#x6570;&#x636E;&#x8BA1;&#x7B97;&#x4E4B;&#x540E;&#x5C06;&#x7ED3;&#x679C;&#x5199;&#x56DE;&#x5230;MySQL&#x6570;&#x636E;&#x5E93;&#x8868;&#x4E2D;</p>
<pre><code class="lang-scala"><span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">ReadWrite</span> </span>{
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span></span>(args: <span class="hljs-type">Array</span>[<span class="hljs-type">String</span>]): <span class="hljs-type">Unit</span> = {
    <span class="hljs-keyword">val</span> url = <span class="hljs-string">&quot;jdbc:mysql://node03:3306/spark&quot;</span>

    <span class="hljs-keyword">val</span> readTableName = <span class="hljs-string">&quot;user&quot;</span>
    <span class="hljs-keyword">val</span> writeTableName = <span class="hljs-string">&quot;newuser&quot;</span>

    <span class="hljs-keyword">val</span> properties = <span class="hljs-keyword">new</span> <span class="hljs-type">Properties</span>()
    properties.setProperty(<span class="hljs-string">&quot;user&quot;</span>, <span class="hljs-string">&quot;root&quot;</span>)
    properties.setProperty(<span class="hljs-string">&quot;password&quot;</span>, <span class="hljs-string">&quot;root&quot;</span>)

    <span class="hljs-comment">// val config = Config.getLocalConfig(getClass.getName)</span>
    <span class="hljs-keyword">val</span> config = <span class="hljs-type">Config</span>.getServerConfig(getClass.getName)

    <span class="hljs-keyword">val</span> sparkSession = <span class="hljs-type">SparkSession</span>.builder().config(config).getOrCreate()

    <span class="hljs-comment">// &#x8BFB;&#x53D6;&#x6570;&#x636E;</span>
    <span class="hljs-keyword">val</span> readDF = sparkSession.read.jdbc(url, readTableName, properties)
    <span class="hljs-comment">// readDF.printSchema()</span>
    <span class="hljs-comment">// readDF.show()</span>

    <span class="hljs-comment">// &#x521B;&#x5EFA;&#x4E34;&#x65F6;&#x8868;</span>
    readDF.createTempView(<span class="hljs-string">&quot;user&quot;</span>)

    <span class="hljs-comment">// &#x5904;&#x7406;&#x6570;&#x636E;</span>
    <span class="hljs-keyword">val</span> writeDF = sparkSession.sql(<span class="hljs-string">&quot;select id, name, age, age-10 as newhope from user&quot;</span>)

    <span class="hljs-comment">// &#x5199;&#x5165;&#x6570;&#x636E;</span>
    <span class="hljs-comment">// mode</span>
    <span class="hljs-comment">// overwrite  &#x8868;&#x793A;&#x8986;&#x76D6;&#xFF0C;&#x5982;&#x679C;&#x8868;&#x4E0D;&#x5B58;&#x5728;&#xFF0C;&#x521B;&#x5EFA;</span>
    <span class="hljs-comment">// append     &#x8868;&#x793A;&#x8FFD;&#x52A0;&#xFF0C;&#x5982;&#x679C;&#x8868;&#x4E0D;&#x5B58;&#x5728;&#xFF0C;&#x521B;&#x5EFA;</span>
    <span class="hljs-comment">// ignore     &#x8868;&#x793A;&#x5FFD;&#x7565;&#xFF0C;&#x5982;&#x679C;&#x8868;&#x5B58;&#x5728;&#xFF0C;&#x4E0D;&#x8FDB;&#x884C;&#x4EFB;&#x4F55;&#x64CD;&#x4F5C;</span>
    <span class="hljs-comment">// error      &#x5982;&#x679C;&#x8868;&#x5B58;&#x5728;&#xFF0C;&#x62A5;&#x9519;&#xFF08;&#x9ED8;&#x8BA4;&#x9009;&#x9879;&#xFF09;</span>
    writeDF.write.mode(<span class="hljs-string">&quot;overwrite&quot;</span>).jdbc(url, writeTableName, properties)

    sparkSession.stop()
  }
}
</code></pre>
</li>
</ul>
<ul>
<li><p>&#x96C6;&#x7FA4;&#x8FD0;&#x884C;</p>
<pre><code class="lang-bash"><span class="hljs-comment"># --driver-class-path &#x6307;&#x5B9A; Driver &#x7AEF;&#x6240;&#x9700;&#x8981;&#x7684;jar</span>
<span class="hljs-comment"># --jars &#x6307;&#x5B9A; Executor &#x7AEF;&#x6240;&#x9700;&#x8981;&#x7684;jar</span>
spark-submit --master spark://node01:7077 \
--executor-memory 1g --total-executor-cores 2 \
--class com.sciatta.hadoop.spark.example.sql.mysql.ReadWrite \
--driver-class-path /bigdata/soft/mysql-connector-java-5.1.38.jar \
--jars /bigdata/soft/mysql-connector-java-5.1.38.jar \
hadoop-spark-example-1.0-SNAPSHOT.jar
</code></pre>
</li>
</ul>
<footer class="page-footer"><span class="copyright">Copyright &#xA9; sciatta.com 2020 all right reserved&#xFF0C;powered by Gitbook</span><span class="footer-modification">&#x4FEE;&#x8BA2;&#x65F6;&#x95F4;: 
2021-02-28 20:16:31
</span></footer>
<script>console.log("plugin-popup....");document.onclick = function(e){ e.target.tagName === "IMG" && window.open(e.target.src,e.target.src)}</script><style>img{cursor:pointer}</style>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                
                <a href="../Spark集群安装部署.html" class="navigation navigation-next navigation-unique" aria-label="Next page: Spark集群安装部署">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"SparkSQL核心功能","level":"1.2.13.2.1","depth":4,"next":{"title":"Spark集群安装部署","level":"1.2.13.3","depth":3,"path":"src/develop/spark/Spark集群安装部署.md","ref":"src/develop/spark/Spark集群安装部署.md","articles":[]},"previous":{"title":"SparkSQL","level":"1.2.13.2","depth":3,"ref":"","articles":[{"title":"SparkSQL核心功能","level":"1.2.13.2.1","depth":4,"path":"src/develop/spark/sparksql/SparkSQL核心功能.md","ref":"src/develop/spark/sparksql/SparkSQL核心功能.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["hide-element","expandable-chapters","code","splitter","-lunr","-search","search-pro","pageview-count","tbfed-pagefooter","popup","auto-scroll-table","-sharing","github","github-buttons","ga","baidu-v3","donate","anchors","anchor-navigation-ex","sitemap"],"pluginsConfig":{"tbfed-pagefooter":{"copyright":"Copyright &copy sciatta.com 2020","modify_label":"修订时间: ","modify_format":"YYYY-MM-DD HH:mm:ss"},"github":{"url":"https://github.com/sciatta"},"splitter":{},"search-pro":{},"auto-scroll-table":{},"popup":{},"code":{"copyButtons":true},"donate":{"alipay":"/develop-stack/assets/alipay.jpg","alipayText":" ","button":"捐赠","title":"","wechat":"/develop-stack/assets/wechat.jpg","wechatText":" "},"baidu-v3":{},"hide-element":{"elements":[".gitbook-link"]},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"anchor-navigation-ex":{"associatedWithSummary":false,"float":{"floatIcon":"fa fa-navicon","level1Icon":"fa fa-hand-o-right","level2Icon":"fa fa-hand-o-right","level3Icon":"fa fa-hand-o-right","showLevelIcon":false},"mode":"float","multipleH1":true,"pageTop":{"level1Icon":"fa fa-hand-o-right","level2Icon":"fa fa-hand-o-right","level3Icon":"fa fa-hand-o-right","showLevelIcon":false},"printLog":false,"showGoTop":true,"showLevel":true},"sitemap":{"hostname":"http://www.sciatta.com/"},"pageview-count":{},"github-buttons":{"buttons":[{"user":"sciatta","repo":"develop-stack","type":"star","count":true,"size":"small"}]},"ga":{"configuration":"auto","token":"UA-156491400-1"},"baidu":{"token":"c6612709c010da681bbd4b785968a638"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchors":{},"expandable-chapters":{}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"src/develop/spark/sparksql/SparkSQL核心功能.md","mtime":"2021-02-28T12:16:31.341Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-03-07T13:19:15.450Z"},"basePath":"../../../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../../../gitbook/gitbook.js"></script>
    <script src="../../../../gitbook/theme.js"></script>
    
        
        <script src="../../../../gitbook/gitbook-plugin-hide-element/plugin.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-search-pro/search.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-pageview-count/plugin.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-auto-scroll-table/plugin.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-github-buttons/plugin.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-baidu-v3/baidu-tongji.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-donate/plugin.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

